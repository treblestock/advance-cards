import{m as y,h as d,p as r,q as L,s as I,x as O,g as x}from"./index.15cd588f.js";const S={n:-1,dateStart:new Date().toJSON()},w=y("setsRevisions",()=>{const o=d(r.setsList||[]),s=d({});function u(n,t){r["setRevisions"+n]=t}async function a(n){const t=JSON.parse(localStorage.getItem("setRevisions"+n),L);if(t){s.value[n]=t;return}const e=setsCards.sets[n];s.value[n]=l(e),u(n,s.value[n])}function c(){o.value.forEach(n=>a(n))}function l(n,t){const e=v(t);s.value[n]=e,u(n,e)}function v(n){return Array.isArray(n)?f(n):R(n)}function R(n){const t={};for(const e in n)!n.hasOwnProperty(e)||(t[e]={...S});return t}function f(n){const t={};for(const e of n)t[e]={...S};return t}function h(n,t){const e={},i=s.value[n];for(const C in t)e[C]=C in i?i[C]:{...S};s.value[n]=e,r["setRevisions"+n]=e}function p({setName:n,card:{question:t},isCorrect:e}){if(!e)return;const i=s.value[n][t];i||(s.value[n][t]=S,u(n,s.value[n])),!!I(i.dateStart)&&O(i)<Date.now()&&(s.value[n][t].n++,u(n,s.value[n]))}function g(n){delete s.value[n],r["setRevisions"+n]=null}return{setsList:o,sets:s,loadSetRevisions:a,createInitialStats:l,updateRevisions:h,updateRevisionCardData:p,deleteRevisions:g,onRegister:c}}),E=y("setsCards",()=>{const o=d(r.setsList||[]),s=d({});function u(t,e){r["setCards"+t]=e}async function a(t){const e=r["setCards"+t];e&&(s.value[t]=e)}function c(t){const e=typeof t=="string"?s.value[t]:t;return Object.keys(e).length}const l=x(()=>Object.values(s.value).reduce((t,e)=>t+=c(e),0));function v(t,e){if(s.value[t])throw new Error("Set with name "+t+" already exists");s.value[t]=e,u(t,e),o.value.push(t),r.setsList=o.value,w().createInitialStats(t,e)}function R(t){return s.value[t]}function f(t,e){if(!s.value[t])throw new Error("there is no set with name "+t);s.value[t]=e,r["setCards"+t]=e,w().updateRevisions(t,e)}function h(t){delete s.value[t],r["setCards"+t]=null,o.value=o.value.filter(i=>i!==t),r.setsList=o.value,w().deleteRevisions(t)}function p(t){return JSON.stringify(s.value[t])}function g(t,e){const i=typeof e=="string"?JSON.parse(e):e;o.value.includes(t)?f(t,i):v(t,i)}function n(){o.value.forEach(t=>a(t))}return{setsList:o,sets:s,loadSet:a,getSetCardsLength:c,allSetCardsLength:l,createSet:v,getSet:R,updateSet:f,deleteSet:h,exportSet:p,importSet:g,onRegister:n}});export{w as a,E as u};
