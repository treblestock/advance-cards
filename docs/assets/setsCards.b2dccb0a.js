import{m as w,h,p as a,q as L,s as y,x as I,g as O}from"./index.2300a498.js";const g={n:-1,dateStart:new Date().toJSON()},C=w("setsRevisions",()=>{const o=h(a.setsList||[]),n=h({});function v(t,i){a["setRevisions"+t]=i}async function l(t){const i=JSON.parse(localStorage.getItem("setRevisions"+t),L);if(i){n.value[t]=i;return}const r=setsCards.sets[t];n.value[t]=S(r),v(t,n.value[t])}function f(){o.value.forEach(t=>l(t))}function S(t,i){function r(e){const s={};for(const c in e)!e.hasOwnProperty(c)||(s[c]={...g});return s}const u=r(i);n.value[t]=u,v(t,u)}function d(t,i){const r={},u=n.value[t];for(const e in i)r[e]=e in u?u[e]:{...g};n.value[t]=r,a["setRevisions"+t]=r}function p({setName:t,question:i,isCorrect:r}){if(!r)return;const u=n.value[t][i];u||(n.value[t][i]=g,v(t,n.value[t])),!!y(u.dateStart)&&I(u)<Date.now()&&(n.value[t][i].n++,v(t,n.value[t]))}function R(t){delete n.value[t],a["setRevisions"+t]=null}return{setsList:o,sets:n,loadSetRevisions:l,createInitialStats:S,updateRevisions:d,updateRevisionCardData:p,deleteRevisions:R,onRegister:f}}),E=w("setsCards",()=>{const o=h(a.setsList||[]),n=h({});function v(e,s){a["setCards"+e]=s}async function l(e){const s=a["setCards"+e];s&&(n.value[e]=s)}function f(e){const s=typeof e=="string"?n.value[e]:e;return Object.keys(s).length}const S=O(()=>Object.values(n.value).reduce((e,s)=>e+=f(s),0));function d(e,s){if(n.value[e])throw new Error("Set with name "+e+" already exists");n.value[e]=s,v(e,s),o.value.push(e),a.setsList=o.value,C().createInitialStats(e,s)}function p(e){return n.value[e]}function R(e,s){if(!n.value[e])throw new Error("there is no set with name "+e);n.value[e]=s,a["setCards"+e]=s,C().updateRevisions(e,s)}function t(e){delete n.value[e],a["setCards"+e]=null,o.value=o.value.filter(c=>c!==e),a.setsList=o.value,C().deleteRevisions(e)}function i(e){return JSON.stringify(n.value[e])}function r(e,s){const c=typeof s=="string"?JSON.parse(s):s;o.value.includes(e)?R(e,c):d(e,c)}function u(){o.value.forEach(e=>l(e))}return{setsList:o,sets:n,loadSet:l,getSetCardsLength:f,allSetCardsLength:S,createSet:d,getSet:p,updateSet:R,deleteSet:t,exportSet:i,importSet:r,onRegister:u}});export{C as a,E as u};
